<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infrastructure Planner | BaseConfig</title>
    <meta name="description" content="Calculate scalable units, power requirements, network devices, and costs for your server deployment.">
    <link rel="icon" type="image/png" href="/assets/logo.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        primary: '#22d3ee',
                        secondary: '#64748b',
                        accent: '#06b6d4',
                    }
                }
            }
        }
    </script>
</head>
<body class="gradient-bg min-h-screen font-sans text-gray-100">
    <!-- Setup Wizard Modal -->
    <div id="wizardOverlay" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4">
        <div class="card rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-6">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold font-mono"><span class="text-cyan-500">&gt;</span> <span class="text-cyan-400">infra_planner</span><span class="text-cyan-400 cursor-blink">_</span></h2>
                    <p class="text-gray-400 mt-2">Let's configure your deployment in a few steps</p>
                </div>
                
                <!-- Progress Steps -->
                <div class="flex justify-center mb-8">
                    <div class="flex items-center gap-2">
                        <div id="step1Indicator" class="w-8 h-8 rounded-full bg-cyan-500 flex items-center justify-center text-sm font-bold">1</div>
                        <div class="w-12 h-1 bg-slate-600" id="step1Bar"></div>
                        <div id="step2Indicator" class="w-8 h-8 rounded-full bg-slate-600 flex items-center justify-center text-sm font-bold">2</div>
                        <div class="w-12 h-1 bg-slate-600" id="step2Bar"></div>
                        <div id="step3Indicator" class="w-8 h-8 rounded-full bg-slate-600 flex items-center justify-center text-sm font-bold">3</div>
                    </div>
                </div>

                <!-- Step 1: Basic Info -->
                <div id="wizardStep1" class="wizard-step space-y-6">
                    <h3 class="text-lg font-semibold flex items-center gap-2"><i data-lucide="server" class="w-5 h-5 text-cyan-400"></i>Basic Configuration</h3>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Total Servers to Refresh *</label>
                        <input type="number" id="wizardTotalServers" value="1000" min="1" class="input-field w-full px-4 py-3 rounded-lg text-white text-lg">
                    </div>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Workload Type *</label>
                        <select id="wizardWorkloadType" class="input-field w-full px-4 py-3 rounded-lg text-white" onchange="updateWorkloadDefaults()">
                            <option value="">-- Select Workload Type --</option>
                            <optgroup label="Most Common">
                                <option value="gp_local_intel">General Purpose Local Intel</option>
                                <option value="hypervisor">Hypervisor (VMware/Hyper-V)</option>
                                <option value="container_worker">Container Worker (Kubernetes)</option>
                                <option value="db_local_intel">Database Local (SQL/PostgreSQL)</option>
                            </optgroup>
                            <optgroup label="High Performance">
                                <option value="high_compute">High Compute (HPC/AI/ML)</option>
                                <option value="hadoop_data_node">Hadoop/Spark Data Node</option>
                                <option value="datawarehouse_amd">DataWarehouse - AMD</option>
                                <option value="datawarehouse_intel">DataWarehouse - Intel</option>
                            </optgroup>
                            <optgroup label="Database Optimized">
                                <option value="db_san_intel">Database SAN Intel (Clustered)</option>
                                <option value="db_local_amd">Database Local AMD</option>
                                <option value="db_san_amd">Database SAN AMD (Clustered)</option>
                                <option value="oracle_db_intel">Oracle DB (License Optimized)</option>
                            </optgroup>
                            <optgroup label="Storage & Logging">
                                <option value="logging">Logging (Splunk/ELK)</option>
                                <option value="data_storage">Data Storage Servers</option>
                            </optgroup>
                            <optgroup label="SAN-Attached">
                                <option value="gp_san_intel">General Purpose SAN Intel</option>
                                <option value="gp_san_amd">General Purpose SAN AMD</option>
                            </optgroup>
                        </select>
                        <p class="text-xs text-emerald-400 mt-1" id="workloadDescription"></p>
                        <div id="workloadSpecs" class="hidden mt-3 p-3 bg-slate-800/50 rounded-lg border border-slate-600/50">
                            <div class="grid grid-cols-2 gap-2 text-xs" id="workloadSpecsContent"></div>
                        </div>
                        <details class="mt-3 text-xs">
                            <summary class="text-cyan-400 cursor-pointer hover:text-cyan-300">Not sure which to pick?</summary>
                            <div class="mt-2 p-3 bg-slate-800/50 rounded-lg text-gray-400 space-y-1">
                                <p><strong class="text-white">Web/App servers:</strong> General Purpose Local Intel</p>
                                <p><strong class="text-white">VMs (VMware/Hyper-V):</strong> Hypervisor</p>
                                <p><strong class="text-white">Kubernetes/Docker:</strong> Container Worker</p>
                                <p><strong class="text-white">SQL/PostgreSQL/MySQL:</strong> Database Local Intel</p>
                                <p><strong class="text-white">Oracle:</strong> Oracle DB (optimizes licensing costs)</p>
                                <p><strong class="text-white">Analytics/BI:</strong> DataWarehouse</p>
                                <p><strong class="text-white">Big Data (Hadoop/Spark):</strong> Hadoop Data Node</p>
                            </div>
                        </details>
                    </div>
                    
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <label class="text-sm text-gray-400">Partner Discount Level</label>
                            <span class="text-xl font-bold text-emerald-400" id="wizardDiscountDisplay">60%</span>
                        </div>
                        <input type="range" id="wizardDiscountSlider" min="40" max="75" value="60" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500" oninput="updateWizardDiscount()">
                        <div class="flex justify-between text-xs text-gray-500 mt-1">
                            <span>40%</span>
                            <span>50%</span>
                            <span>60%</span>
                            <span>75%</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1" id="wizardDiscountDescription">You pay 40% of list price</p>
                    </div>
                </div>

                <!-- Step 2: Power & Rack -->
                <div id="wizardStep2" class="wizard-step hidden space-y-6">
                    <h3 class="text-lg font-semibold flex items-center gap-2"><i data-lucide="zap" class="w-5 h-5 text-yellow-400"></i>Power & Rack Configuration</h3>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Rack Power Limit (kW) *</label>
                        <div class="grid grid-cols-4 gap-2 mb-2">
                            <button type="button" onclick="setRackPower(8)" class="rack-power-btn px-3 py-2 rounded bg-slate-700 hover:bg-slate-600 text-sm">8 kW</button>
                            <button type="button" onclick="setRackPower(10)" class="rack-power-btn px-3 py-2 rounded bg-slate-700 hover:bg-slate-600 text-sm">10 kW</button>
                            <button type="button" onclick="setRackPower(15)" class="rack-power-btn px-3 py-2 rounded bg-slate-700 hover:bg-slate-600 text-sm">15 kW</button>
                            <button type="button" onclick="setRackPower(20)" class="rack-power-btn px-3 py-2 rounded bg-slate-700 hover:bg-slate-600 text-sm">20 kW</button>
                        </div>
                        <input type="number" id="wizardRackPower" value="10" min="1" class="input-field w-full px-4 py-3 rounded-lg text-white" onchange="updatePowerPreview()">
                        <p class="text-xs text-gray-500 mt-1">Most datacenters limit racks to 10kW. This is often the primary constraint.</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Scalable Unit Layout</label>
                        <div class="grid grid-cols-3 gap-3">
                            <button type="button" id="layoutSingle" onclick="selectRackLayout('single')" class="rack-layout-btn p-3 rounded-lg border-2 border-cyan-500 bg-cyan-500/30 transition-all text-left">
                                <div class="flex items-center gap-2 mb-1">
                                    <i data-lucide="square" class="w-4 h-4 text-cyan-400"></i>
                                    <span class="font-semibold text-sm">Single</span>
                                </div>
                                <div class="text-xs text-gray-400">2 ToRs, 1 rack</div>
                            </button>
                            <button type="button" id="layoutSplit" onclick="selectRackLayout('split')" class="rack-layout-btn p-3 rounded-lg border-2 border-slate-600 hover:border-purple-500 transition-all text-left">
                                <div class="flex items-center gap-2 mb-1">
                                    <i data-lucide="columns" class="w-4 h-4 text-purple-400"></i>
                                    <span class="font-semibold text-sm">Split</span>
                                </div>
                                <div class="text-xs text-gray-400">2 ToRs, 2 racks</div>
                            </button>
                            <button type="button" id="layoutSuperSplit" onclick="selectRackLayout('supersplit')" class="rack-layout-btn p-3 rounded-lg border-2 border-slate-600 hover:border-orange-500 transition-all text-left">
                                <div class="flex items-center gap-2 mb-1">
                                    <i data-lucide="layout-grid" class="w-4 h-4 text-orange-400"></i>
                                    <span class="font-semibold text-sm">Super Split</span>
                                </div>
                                <div class="text-xs text-gray-400">2 ToRs, 4 racks</div>
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-2" id="layoutDescription">Standard layout: each scalable unit fits in one rack.</p>
                    </div>
                    
                    <div class="p-4 bg-slate-800 rounded-lg">
                        <h4 class="font-semibold mb-3 flex items-center gap-2"><i data-lucide="calculator" class="w-4 h-4 text-green-400"></i>Power Estimate Preview</h4>
                        <div id="powerPreview" class="space-y-2 text-sm"></div>
                    </div>
                </div>

                <!-- Step 3: Refresh Rate -->
                <div id="wizardStep3" class="wizard-step hidden space-y-6">
                    <h3 class="text-lg font-semibold flex items-center gap-2"><i data-lucide="refresh-cw" class="w-5 h-5 text-cyan-400"></i>Refresh Rate Options</h3>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Run Rate (servers/month)</label>
                        <input type="number" id="wizardRunRate" value="250" min="1" class="input-field w-full px-4 py-3 rounded-lg text-white">
                        <p class="text-xs text-gray-500 mt-1">Standard deployment pace with existing resources</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm text-gray-400 mb-2">Rack & Roll Rate (servers/month)</label>
                        <input type="number" id="wizardRackRollRate" value="1000" min="1" class="input-field w-full px-4 py-3 rounded-lg text-white">
                        <p class="text-xs text-gray-500 mt-1">Accelerated deployment with additional resources/contractors</p>
                    </div>
                    
                    <div class="p-4 bg-slate-800 rounded-lg">
                        <h4 class="font-semibold mb-3">Timeline Preview</h4>
                        <div id="timelinePreview" class="space-y-2 text-sm"></div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="flex justify-between mt-8 pt-6 border-t border-slate-600">
                    <button id="wizardBack" onclick="wizardPrevStep()" class="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg font-medium transition-colors hidden">
                        <span class="flex items-center gap-2"><i data-lucide="arrow-left" class="w-4 h-4"></i>Back</span>
                    </button>
                    <div class="flex-1"></div>
                    <button id="wizardNext" onclick="wizardNextStep()" class="px-6 py-3 bg-cyan-500 hover:bg-cyan-600 rounded-lg font-medium transition-colors">
                        <span class="flex items-center gap-2">Next<i data-lucide="arrow-right" class="w-4 h-4"></i></span>
                    </button>
                    <button id="wizardFinish" onclick="finishWizard()" class="px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-medium transition-colors hidden">
                        <span class="flex items-center gap-2"><i data-lucide="check" class="w-4 h-4"></i>Start Planning</span>
                    </button>
                </div>
                
                <div class="text-center mt-4">
                    <button onclick="skipWizard()" class="text-sm text-gray-500 hover:text-gray-300">Skip wizard and use defaults</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8 max-w-7xl" id="mainContent">
        <header class="mb-8">
            <div class="flex justify-between items-center mb-4">
                <a href="/" class="inline-flex items-center gap-2 text-gray-400 hover:text-white transition-colors">
                    <i data-lucide="arrow-left" class="w-4 h-4"></i> Back to BaseConfig
                </a>
                <a href="/tools/storage-calculator/" class="text-gray-300 hover:text-cyan-400 transition-colors text-sm flex items-center gap-1">
                    <i data-lucide="hard-drive" class="w-4 h-4"></i> Storage Calculator
                </a>
            </div>
            <div class="text-center">
                <h1 class="text-4xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent mb-2">
                    Infrastructure Planning Calculator
                </h1>
                <p class="text-gray-400">Plan your server refresh, budget, and timeline with precision</p>
            </div>
        </header>

        <nav class="flex flex-wrap justify-center gap-2 mb-8">
            <button onclick="showTab('config')" id="tab-config" class="tab-btn tab-active px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="settings" class="w-4 h-4"></i>Config</span>
            </button>
            <button onclick="showTab('scalable')" id="tab-scalable" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="server" class="w-4 h-4"></i>Units</span>
            </button>
            <button onclick="showTab('visualize')" id="tab-visualize" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="layout" class="w-4 h-4"></i>Visualize</span>
            </button>
            <button onclick="showTab('network')" id="tab-network" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="network" class="w-4 h-4"></i>Network</span>
            </button>
            <button onclick="showTab('migration')" id="tab-migration" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="git-compare" class="w-4 h-4"></i>Migration</span>
            </button>
            <button onclick="showTab('timeline')" id="tab-timeline" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="calendar" class="w-4 h-4"></i>Timeline</span>
            </button>
            <button onclick="showTab('costs')" id="tab-costs" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="dollar-sign" class="w-4 h-4"></i>Costs</span>
            </button>
            <button onclick="showTab('advanced')" id="tab-advanced" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="sliders" class="w-4 h-4"></i>Advanced</span>
            </button>
            <button onclick="showTab('summary')" id="tab-summary" class="tab-btn px-3 py-2 rounded-t-lg font-medium transition-all hover:bg-slate-700/50 text-sm">
                <span class="flex items-center gap-1"><i data-lucide="file-text" class="w-4 h-4"></i>Summary</span>
            </button>
        </nav>

        <!-- Configuration Tab -->
        <section id="section-config" class="tab-section animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Workload & Network Summary Card -->
                <div class="card rounded-xl p-6 lg:col-span-2 highlight-card">
                    <div class="flex justify-between items-start">
                        <div>
                            <h2 class="text-xl font-semibold mb-2 flex items-center gap-2">
                                <i data-lucide="cpu" class="w-5 h-5 text-cyan-400"></i>Current Configuration
                            </h2>
                            <div class="flex flex-wrap gap-4 text-sm">
                                <span class="px-3 py-1 bg-cyan-500/50 rounded-full" id="configWorkloadBadge">General Purpose</span>
                                <span class="px-3 py-1 bg-purple-900/50 rounded-full" id="configNetworkBadge">25G Network</span>
                                <span class="px-3 py-1 bg-yellow-900/50 rounded-full" id="configPowerBadge">10kW Rack Limit</span>
                                <span class="px-3 py-1 bg-emerald-900/50 rounded-full" id="configDiscountBadge">60% Discount</span>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="showWizard()" class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm flex items-center gap-2">
                                <i data-lucide="wand-2" class="w-4 h-4"></i>Re-run Wizard
                            </button>
                            <button id="shareBtn" onclick="copyShareableURL()" class="px-4 py-2 bg-cyan-700 hover:bg-cyan-600 rounded-lg text-sm flex items-center gap-2 transition-colors">
                                <i data-lucide="share-2" class="w-4 h-4"></i>Share
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Deployment Scale Summary -->
                <div class="card rounded-xl p-6 lg:col-span-2 border-2 border-cyan-500/30">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="layout-grid" class="w-5 h-5 text-cyan-400"></i>Deployment Scale
                    </h2>
                    <div id="deployment-scale-summary" class="grid grid-cols-2 md:grid-cols-5 gap-4 text-center">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Network Topology Diagram -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-semibold flex items-center gap-2">
                            <i data-lucide="network" class="w-5 h-5 text-green-400"></i>Network Topology
                        </h2>
                        <div class="flex gap-2">
                            <button onclick="exportToDrawio()" class="px-3 py-1.5 bg-orange-600 hover:bg-orange-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-1">
                                <i data-lucide="share-2" class="w-4 h-4"></i>Export to Draw.io
                            </button>
                            <button onclick="exportConfigTopologyAsPNG()" class="px-3 py-1.5 bg-purple-600 hover:bg-purple-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-1">
                                <i data-lucide="image" class="w-4 h-4"></i>Export PNG
                            </button>
                        </div>
                    </div>
                    <div id="network-topology-diagram" class="bg-slate-900 rounded-lg p-4 overflow-x-auto">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="server" class="w-5 h-5 text-cyan-400"></i>Server Configuration
                    </h2>
                    <div class="space-y-4">
                        <div><label class="block text-sm text-gray-400 mb-1">Total Servers to Refresh</label>
                        <input type="number" id="totalServers" value="1000" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()">
                        <div class="flex flex-wrap gap-2 mt-2">
                            <button type="button" onclick="setPresetServers(100)" class="px-3 py-1 text-xs bg-slate-700 hover:bg-slate-600 rounded transition-colors">100</button>
                            <button type="button" onclick="setPresetServers(500)" class="px-3 py-1 text-xs bg-slate-700 hover:bg-slate-600 rounded transition-colors">500</button>
                            <button type="button" onclick="setPresetServers(1000)" class="px-3 py-1 text-xs bg-slate-700 hover:bg-slate-600 rounded transition-colors">1,000</button>
                            <button type="button" onclick="setPresetServers(5000)" class="px-3 py-1 text-xs bg-slate-700 hover:bg-slate-600 rounded transition-colors">5,000</button>
                            <button type="button" onclick="setPresetServers(10000)" class="px-3 py-1 text-xs bg-slate-700 hover:bg-slate-600 rounded transition-colors">10,000</button>
                        </div>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Workload Type</label>
                            <select id="workloadType" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="applyWorkloadPreset(); calculate()">
                                <optgroup label="Most Common">
                                    <option value="gp_local_intel">General Purpose Local Intel</option>
                                    <option value="hypervisor">Hypervisor (VMware/Hyper-V)</option>
                                    <option value="container_worker">Container Worker (Kubernetes)</option>
                                    <option value="db_local_intel">Database Local (SQL/PostgreSQL)</option>
                                </optgroup>
                                <optgroup label="High Performance">
                                    <option value="high_compute">High Compute (HPC/AI/ML)</option>
                                    <option value="hadoop_data_node">Hadoop/Spark Data Node</option>
                                    <option value="datawarehouse_amd">DataWarehouse - AMD</option>
                                    <option value="datawarehouse_intel">DataWarehouse - Intel</option>
                                </optgroup>
                                <optgroup label="Database Optimized">
                                    <option value="db_san_intel">Database SAN Intel (Clustered)</option>
                                    <option value="db_local_amd">Database Local AMD</option>
                                    <option value="db_san_amd">Database SAN AMD (Clustered)</option>
                                    <option value="oracle_db_intel">Oracle DB (License Optimized)</option>
                                </optgroup>
                                <optgroup label="Storage & Logging">
                                    <option value="logging">Logging (Splunk/ELK)</option>
                                    <option value="data_storage">Data Storage Servers</option>
                                </optgroup>
                                <optgroup label="SAN-Attached">
                                    <option value="gp_san_intel">General Purpose SAN Intel</option>
                                    <option value="gp_san_amd">General Purpose SAN AMD</option>
                                </optgroup>
                            </select>
                        </div>
                        <div><label class="block text-sm text-gray-400 mb-1">Server Power Consumption (Watts)</label>
                        <input type="number" id="serverPower" value="750" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Server Cost ($)</label>
                        <input type="number" id="serverCost" value="8500" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                    </div>
                </div>

                <!-- BOM Section -->
                <div id="bomSection" class="card rounded-xl p-6 lg:col-span-2 hidden">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="list" class="w-5 h-5 text-cyan-400"></i>Bill of Materials (Per Server)
                    </h2>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b border-slate-600">
                                    <th class="text-left py-2 px-3 text-gray-400">Part Number</th>
                                    <th class="text-left py-2 px-3 text-gray-400">Description</th>
                                    <th class="text-right py-2 px-3 text-gray-400">Qty</th>
                                </tr>
                            </thead>
                            <tbody id="bomTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="layout-grid" class="w-5 h-5 text-purple-400"></i>
                        <span class="tooltip" data-tip="Configure rack power limits, layout, and physical constraints. Power is often the primary limiting factor.">Rack Configuration</span>
                    </h2>
                    <div class="space-y-4">
                        <div><label class="block text-sm text-gray-400 mb-1">Rack Power Capacity (kW)</label>
                        <input type="number" id="rackPower" value="10" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()">
                        <p class="text-xs text-yellow-500 mt-1">⚠️ This is often the primary constraint</p></div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1"><span class="tooltip" data-tip="Single = 2 ToRs in 1 rack (power-limited). Split = 1 ToR per rack across 2 racks (more servers per unit).">Scalable Unit Layout</span></label>
                            <select id="rackLayout" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()">
                                <option value="single">Single Rack (2 ToRs, 1 rack)</option>
                                <option value="split">Split (2 ToRs, 2 racks)</option>
                                <option value="supersplit">Super Split (2 ToRs, 4 racks)</option>
                            </select>
                        </div>
                        <div><label class="block text-sm text-gray-400 mb-1">Rack Units (U) Available</label>
                        <input type="number" id="rackUnits" value="42" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Server Height (U)</label>
                        <input type="number" id="serverHeight" value="1" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Rack Cost ($)</label>
                        <input type="number" id="rackCost" value="3500" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                    </div>
                </div>

                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="network" class="w-5 h-5 text-green-400"></i>
                        <span class="tooltip" data-tip="Configure ToR (Top of Rack) and spine switches. ToRs connect servers, spines aggregate ToRs.">Network Configuration</span>
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Network Speed to Server</label>
                            <select id="networkSpeed" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="applyNetworkPreset(); calculate()">
                                <option value="25g">25G</option>
                                <option value="100g">100G</option>
                            </select>
                        </div>
                        <div><label class="block text-sm text-gray-400 mb-1"><span class="tooltip" data-tip="Total ports on each ToR switch. Some ports are used for spine uplinks, rest for servers.">ToR Switch Ports</span></label>
                        <input type="number" id="torPorts" value="48" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">ToR Switch Cost ($)</label>
                        <input type="number" id="torCost" value="65800.08" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">ToR Switch Power (Watts)</label>
                        <input type="number" id="torPower" value="450" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Spine Switch Cost ($)</label>
                        <input type="number" id="spineCost" value="250552.56" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div class="p-3 bg-slate-800/50 rounded-lg text-xs text-gray-400 mt-2">
                            <div class="font-medium text-cyan-400 mb-1">Switch Models:</div>
                            <div>ToR: N9K-C93180YC-FX3 (48x25G + 6x100G)</div>
                            <div>Spine: N9K-C9364D-GX2A (64x400G, 2U)</div>
                            <div class="text-gray-500 mt-1">Spine count auto-calculated from ToR uplinks</div>
                        </div>
                    </div>
                </div>

                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="zap" class="w-5 h-5 text-yellow-400"></i>Optics Configuration
                    </h2>
                    <div class="space-y-4">
                        <div><label class="block text-sm text-gray-400 mb-1">Server NIC Optics Cost ($)</label>
                        <input type="number" id="serverOpticsCost" value="152.89" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Optics per Server</label>
                        <input type="number" id="opticsPerServer" value="2" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Uplink Optics Cost ($)</label>
                        <input type="number" id="uplinkOpticsCost" value="2073.14" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Uplinks per ToR</label>
                        <input type="number" id="uplinksPerTor" value="4" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                    </div>
                </div>

                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="hard-drive" class="w-5 h-5 text-orange-400"></i>VAST EBox Storage
                    </h2>
                    <div class="space-y-4">
                        <div><label class="block text-sm text-gray-400 mb-1">Storage per Server (TB usable)</label>
                        <input type="number" id="storagePerServer" value="10" min="0" step="0.1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">VAST Drive Option</label>
                        <select id="vastDriveOption" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()">
                            <option value="15.3TB">15.3TB (100TB usable/server)</option>
                            <option value="30.7TB" selected>30.7TB (200TB usable/server)</option>
                            <option value="61.4TB">61.4TB (350TB usable/server)</option>
                        </select></div>
                        <div class="p-3 bg-slate-800/50 rounded-lg text-xs text-gray-400">
                            <div class="flex justify-between mb-1"><span>VAST EBox Servers:</span><span id="vastServersDisplay" class="text-cyan-400 font-medium">0</span></div>
                            <div class="flex justify-between mb-1"><span>VAST Racks:</span><span id="vastRacksDisplay" class="text-cyan-400 font-medium">0</span></div>
                            <div class="flex justify-between"><span>Total Usable Capacity:</span><span id="vastCapacityDisplay" class="text-cyan-400 font-medium">0 TB</span></div>
                        </div>
                        <p class="text-xs text-gray-500">VAST handles data protection internally - no replication factor needed</p>
                    </div>
                </div>

                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="percent" class="w-5 h-5 text-emerald-400"></i>Pricing & Discount
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm text-gray-400">Partner Discount</label>
                                <span class="text-lg font-bold text-emerald-400" id="discountDisplay">60%</span>
                            </div>
                            <input type="range" id="discountSlider" min="40" max="75" value="60" class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500" oninput="updateDiscount()">
                            <div class="flex justify-between text-xs text-gray-500 mt-1">
                                <span>40%</span>
                                <span>50%</span>
                                <span>60%</span>
                                <span>75%</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-2">Enterprise discounts typically range from 40-75% off list price.</p>
                        </div>
                        <div class="p-3 bg-slate-800 rounded-lg">
                            <div class="text-sm text-gray-400 mb-1">Pricing Mode</div>
                            <div class="flex items-center gap-2">
                                <span class="text-emerald-400 font-semibold" id="pricingModeLabel">Enterprise Deal (60% off)</span>
                            </div>
                            <p class="text-xs text-gray-500 mt-1" id="discountSavingsPreview">Adjust slider to see pricing at different discount levels</p>
                        </div>
                    </div>
                </div>

                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="refresh-cw" class="w-5 h-5 text-cyan-400"></i>Refresh Rate Options
                    </h2>
                    <div class="space-y-4">
                        <div><label class="block text-sm text-gray-400 mb-1">Run Rate (servers/month)</label>
                        <input type="number" id="runRate" value="250" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Rack & Roll Rate (servers/month)</label>
                        <input type="number" id="rackRollRate" value="1000" min="1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Rack & Roll Premium (%)</label>
                        <input type="number" id="rackRollPremium" value="5" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                        <div><label class="block text-sm text-gray-400 mb-1">Monthly Labor Cost per Server ($)</label>
                        <input type="number" id="laborCostPerServer" value="50" min="0" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()"></div>
                    </div>
                </div>

                <!-- Validation Warnings -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="shield-check" class="w-5 h-5 text-green-400"></i>Validation Status
                    </h2>
                    <div id="validationWarnings" class="space-y-2"></div>
                </div>
            </div>
        </section>

        <!-- Scalable Units Tab -->
        <section id="section-scalable" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="layers" class="w-5 h-5 text-cyan-400"></i>Scalable Unit Breakdown
                    </h2>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead><tr class="border-b border-slate-600">
                                <th class="text-left py-3 px-4 text-gray-400">Component</th>
                                <th class="text-right py-3 px-4 text-gray-400">Per Unit</th>
                                <th class="text-right py-3 px-4 text-gray-400">Total Required</th>
                                <th class="text-right py-3 px-4 text-gray-400">Unit Cost</th>
                                <th class="text-right py-3 px-4 text-gray-400">Total Cost</th>
                            </tr></thead>
                            <tbody id="scalableUnitTable"></tbody>
                        </table>
                    </div>
                </div>
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="bolt" class="w-5 h-5 text-yellow-400"></i>Power Analysis
                    </h2>
                    <div class="space-y-4" id="powerAnalysis"></div>
                </div>
                <div class="lg:col-span-3 grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div class="highlight-card rounded-xl p-4 text-center">
                        <div class="text-3xl font-bold text-cyan-400" id="totalScalableUnits">0</div>
                        <div class="text-sm text-gray-400">Scalable Units</div>
                    </div>
                    <div class="highlight-card rounded-xl p-4 text-center">
                        <div class="text-3xl font-bold text-purple-400" id="totalRacks">0</div>
                        <div class="text-sm text-gray-400">Total Racks</div>
                    </div>
                    <div class="highlight-card rounded-xl p-4 text-center">
                        <div class="text-3xl font-bold text-green-400" id="totalNetworkDevices">0</div>
                        <div class="text-sm text-gray-400">Network Devices</div>
                    </div>
                    <div class="highlight-card rounded-xl p-4 text-center">
                        <div class="text-3xl font-bold text-red-400" id="totalStorageNodes">0</div>
                        <div class="text-sm text-gray-400">Storage Nodes</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Visualize Tab -->
        <section id="section-visualize" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 gap-6">
                <!-- View Toggle -->
                <div class="card rounded-xl p-4">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <div class="flex gap-2">
                            <button onclick="setVisualizationView('rack')" id="viewRack" class="viz-view-btn px-4 py-2 bg-cyan-600 rounded-lg text-sm font-medium">
                                <span class="flex items-center gap-2"><i data-lucide="server" class="w-4 h-4"></i>Rack Diagram</span>
                            </button>
                            <button onclick="setVisualizationView('topology')" id="viewTopology" class="viz-view-btn px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm font-medium">
                                <span class="flex items-center gap-2"><i data-lucide="git-branch" class="w-4 h-4"></i>Network Topology</span>
                            </button>
                            <button onclick="setVisualizationView('datacenter')" id="viewDatacenter" class="viz-view-btn px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm font-medium">
                                <span class="flex items-center gap-2"><i data-lucide="box" class="w-4 h-4"></i>3D Data Center</span>
                            </button>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="exportToDrawio()" class="px-4 py-2 bg-orange-600 hover:bg-orange-700 rounded-lg text-sm font-medium flex items-center gap-2">
                                <i data-lucide="share" class="w-4 h-4"></i>Export to Draw.io
                            </button>
                            <button onclick="exportDiagramAsPNG()" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-sm font-medium flex items-center gap-2">
                                <i data-lucide="image" class="w-4 h-4"></i>Export PNG
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Rack Diagram View -->
                <div id="vizRackView" class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="server" class="w-5 h-5 text-cyan-400"></i>Rack Diagram
                        <span class="text-sm font-normal text-gray-400">Showing sample scalable unit</span>
                    </h2>
                    <div id="rackDiagramContainer" class="flex flex-wrap gap-6 justify-center overflow-x-auto py-4"></div>
                    <div class="mt-4 flex flex-wrap gap-4 text-sm">
                        <div class="flex items-center gap-2"><div class="w-4 h-4 bg-cyan-500 rounded"></div>Server</div>
                        <div class="flex items-center gap-2"><div class="w-4 h-4 bg-purple-500 rounded"></div>ToR Switch</div>
                        <div class="flex items-center gap-2"><div class="w-4 h-4 bg-yellow-500 rounded"></div>Spine Switch</div>
                        <div class="flex items-center gap-2"><div class="w-4 h-4 bg-slate-600 rounded"></div>Empty</div>
                    </div>
                </div>

                <!-- Network Topology View -->
                <div id="vizTopologyView" class="card rounded-xl p-6 hidden">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="git-branch" class="w-5 h-5 text-purple-400"></i>Network Topology
                        <span class="text-sm font-normal text-gray-400">Spine-Leaf Architecture</span>
                    </h2>
                    <div id="networkTopologyDiagram" class="min-h-[500px] relative"></div>
                </div>

                <!-- 3D Data Center View -->
                <div id="vizDatacenterView" class="card rounded-xl p-6 hidden">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="box" class="w-5 h-5 text-green-400"></i>3D Data Center View
                        <span class="text-sm font-normal text-gray-400">Row and Aisle Layout</span>
                    </h2>
                    <div class="mb-4 flex gap-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Racks per Row</label>
                            <input type="number" id="racksPerRow" value="10" min="1" max="20" class="input-field w-24 px-3 py-2 rounded-lg text-white" onchange="render3DDataCenter()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Number of Rows</label>
                            <input type="number" id="numRows" value="4" min="1" max="10" class="input-field w-24 px-3 py-2 rounded-lg text-white" onchange="render3DDataCenter()">
                        </div>
                    </div>
                    <div id="datacenter3DContainer" class="min-h-[500px] relative" style="perspective: 1000px;"></div>
                </div>
            </div>
        </section>

        <!-- Migration Tab -->
        <section id="section-migration" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Historical Server Templates -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="history" class="w-5 h-5 text-cyan-400"></i>Estimate from Historical Server Generation
                    </h2>
                    <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3 mb-4">
                        <p class="text-yellow-400 text-sm flex items-center gap-2">
                            <i data-lucide="alert-triangle" class="w-4 h-4"></i>
                            <span><strong>Note:</strong> These are generalized estimates based on typical server configurations from each era. Actual performance varies by specific model and workload.</span>
                        </p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Server Generation Year</label>
                            <select id="historicalYear" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="updateHistoricalComparison()">
                                <option value="">Select year...</option>
                                <option value="2014">2014 (Haswell Era)</option>
                                <option value="2016">2016 (Broadwell Era)</option>
                                <option value="2018">2018 (Skylake Era)</option>
                                <option value="2020">2020 (Ice Lake Era)</option>
                                <option value="2022">2022 (Sapphire Rapids Era)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Server Type</label>
                            <select id="historicalType" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="updateHistoricalComparison()">
                                <option value="">Select type...</option>
                                <option value="high_compute">High Compute (2P)</option>
                                <option value="general_purpose">General Purpose (2P)</option>
                                <option value="database">Database Optimized</option>
                                <option value="storage">Storage Dense</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Number of Old Servers</label>
                            <input type="number" id="historicalCount" value="100" min="1" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="updateHistoricalComparison()">
                        </div>
                    </div>
                    <div id="historicalComparison" class="text-gray-400 text-sm">
                        <p>Select a server generation and type to see estimated performance gains.</p>
                    </div>
                </div>

                <!-- Import Existing Infrastructure -->
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="upload" class="w-5 h-5 text-cyan-400"></i>Import Custom Inventory
                    </h2>
                    <p class="text-gray-400 text-sm mb-4">Or upload a CSV/JSON file with your specific server inventory.</p>
                    <div class="space-y-4">
                        <div class="border-2 border-dashed border-slate-600 rounded-lg p-4 text-center hover:border-cyan-500 transition-colors cursor-pointer" onclick="document.getElementById('migrationFileInput').click()">
                            <i data-lucide="file-up" class="w-8 h-8 mx-auto text-gray-500 mb-2"></i>
                            <p class="text-gray-400 text-sm">Click to upload</p>
                            <p class="text-xs text-gray-500">CSV or JSON format</p>
                            <input type="file" id="migrationFileInput" accept=".csv,.json" class="hidden" onchange="handleMigrationFileUpload(event)">
                        </div>
                    </div>
                </div>

                <!-- Current Infrastructure Summary -->
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="database" class="w-5 h-5 text-yellow-400"></i>Current Infrastructure
                    </h2>
                    <div id="currentInfraSummary" class="text-gray-400 text-sm">
                        <p>Select historical server generation above or import custom inventory to begin migration planning.</p>
                    </div>
                </div>

                <!-- Migration Comparison -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="git-compare" class="w-5 h-5 text-purple-400"></i>Migration Comparison
                    </h2>
                    <div id="migrationComparison" class="text-gray-400 text-sm">
                        <p>Import existing infrastructure to see comparison with refresh plan.</p>
                    </div>
                </div>

                <!-- Migration Efficiency Analysis -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="calculator" class="w-5 h-5 text-green-400"></i>Migration Efficiency Analysis
                    </h2>
                    <p class="text-gray-400 text-sm mb-4">Compare the cost of running old hardware longer (Run Rate) vs. investing in faster deployment (Rack & Roll).</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Old Server Power (W)</label>
                            <input type="number" id="oldServerPower" value="500" min="100" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationEfficiency()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Power Cost ($/kWh)</label>
                            <input type="number" id="migrationPowerCost" value="0.10" min="0" step="0.01" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationEfficiency()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Run Rate (servers/mo)</label>
                            <input type="number" id="runRateServers" value="250" min="1" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationEfficiency()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Rack & Roll (servers/mo)</label>
                            <input type="number" id="rackRollServers" value="500" min="1" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationEfficiency()">
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Rack & Roll Premium (%)</label>
                            <input type="number" id="rackRollPremium" value="5" min="0" max="100" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationEfficiency()">
                            <p class="text-xs text-gray-500 mt-1">Extra cost for expedited deployment</p>
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">PUE Factor</label>
                            <input type="number" id="migrationPUE" value="1.5" min="1" max="3" step="0.1" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationEfficiency()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Old Hardware Maint ($/server/mo)</label>
                            <input type="number" id="oldHardwareMaint" value="50" min="0" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationEfficiency()">
                        </div>
                    </div>
                    <div id="migrationEfficiencyResults"></div>
                </div>

                <!-- Migration Timeline -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="calendar-clock" class="w-5 h-5 text-cyan-400"></i>Migration Timeline
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Migration Start Date</label>
                            <input type="date" id="migrationStartDate" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationTimeline()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Servers per Week</label>
                            <input type="number" id="migrationServersPerWeek" value="50" min="1" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationTimeline()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Parallel Migrations</label>
                            <input type="number" id="parallelMigrations" value="2" min="1" max="10" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="calculateMigrationTimeline()">
                        </div>
                    </div>
                    <div id="migrationTimeline"></div>
                </div>
            </div>
        </section>

        <!-- Network Tab -->
        <section id="section-network" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="git-branch" class="w-5 h-5 text-cyan-400"></i>Network Topology Analysis
                    </h2>
                    <div id="networkTopologyAnalysis"></div>
                </div>
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="cable" class="w-5 h-5 text-purple-400"></i>Cabling Estimates
                    </h2>
                    <div id="cablingEstimates"></div>
                </div>
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="zap" class="w-5 h-5 text-yellow-400"></i>Power Efficiency Metrics
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">PUE (Power Usage Effectiveness)</label>
                            <input type="number" id="pueValue" value="1.5" min="1" max="3" step="0.1" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Power Cost ($/kWh)</label>
                            <input type="number" id="powerCostPerKwh" value="0.10" min="0" step="0.01" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()">
                        </div>
                    </div>
                    <div id="powerEfficiencyMetrics"></div>
                </div>
            </div>
        </section>

        <!-- Timeline Tab -->
        <section id="section-timeline" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="clock" class="w-5 h-5 text-cyan-400"></i>Run Rate Timeline
                        <span class="text-sm font-normal text-gray-400" id="runRateLabel">(250/month)</span>
                    </h2>
                    <div id="runRateTimeline" class="space-y-3"></div>
                </div>
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="rocket" class="w-5 h-5 text-purple-400"></i>Rack & Roll Timeline
                        <span class="text-sm font-normal text-gray-400" id="rackRollLabel">(1000/month)</span>
                    </h2>
                    <div id="rackRollTimeline" class="space-y-3"></div>
                </div>
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="git-compare" class="w-5 h-5 text-green-400"></i>Timeline Comparison
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="timelineComparison"></div>
                </div>
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="bar-chart-3" class="w-5 h-5 text-cyan-400"></i>Monthly Progress Projection
                    </h2>
                    <div class="overflow-x-auto"><div id="progressChart" class="min-w-[600px]"></div></div>
                </div>
            </div>
        </section>

        <!-- Cost Analysis Tab -->
        <section id="section-costs" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="wallet" class="w-5 h-5 text-cyan-400"></i>Run Rate Cost Breakdown
                    </h2>
                    <div id="runRateCosts" class="space-y-3"></div>
                    <div class="mt-4 pt-4 border-t border-slate-600">
                        <div class="flex justify-between items-center text-lg font-semibold">
                            <span>Total Cost</span><span class="text-cyan-400" id="runRateTotalCost">$0</span>
                        </div>
                    </div>
                </div>
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="credit-card" class="w-5 h-5 text-purple-400"></i>Rack & Roll Cost Breakdown
                    </h2>
                    <div id="rackRollCosts" class="space-y-3"></div>
                    <div class="mt-4 pt-4 border-t border-slate-600">
                        <div class="flex justify-between items-center text-lg font-semibold">
                            <span>Total Cost</span><span class="text-purple-400" id="rackRollTotalCost">$0</span>
                        </div>
                    </div>
                </div>
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="scale" class="w-5 h-5 text-green-400"></i>Cost Comparison Analysis
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="costComparison"></div>
                </div>
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="trending-up" class="w-5 h-5 text-yellow-400"></i>Monthly Budget Requirements
                    </h2>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead><tr class="border-b border-slate-600">
                                <th class="text-left py-3 px-4 text-gray-400">Month</th>
                                <th class="text-right py-3 px-4 text-gray-400">Run Rate Spend</th>
                                <th class="text-right py-3 px-4 text-gray-400">Run Rate Cumulative</th>
                                <th class="text-right py-3 px-4 text-gray-400">Rack & Roll Spend</th>
                                <th class="text-right py-3 px-4 text-gray-400">Rack & Roll Cumulative</th>
                            </tr></thead>
                            <tbody id="monthlyBudgetTable"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <!-- Advanced Tab -->
        <section id="section-advanced" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Spine Breakout Configuration -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="cable" class="w-5 h-5 text-orange-400"></i>Spine Uplink Configuration
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm text-gray-400 mb-1">Spine Uplink Mode</label>
                                <select id="spineUplinkMode" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="updateSpineUplinkMode(); calculate()">
                                    <option value="direct" selected>Direct 100G (100G optic in 400G port)</option>
                                    <option value="breakout">4:1 Breakout (400G → 4x100G) - Advanced</option>
                                </select>
                            </div>
                            <div id="breakoutOpticsCostDiv" style="display: none;">
                                <label class="block text-sm text-gray-400 mb-1">Breakout Optic Cost ($)</label>
                                <input type="number" id="breakoutOpticsCost" value="1558.76" min="0" step="0.01" class="input-field w-full px-4 py-2 rounded-lg text-white" onchange="calculate()">
                                <p class="text-xs text-gray-500 mt-1">QDD-400G-SR4.2-BD: $6,235.02 list @ 75% = $1,558.76</p>
                            </div>
                        </div>
                        <div class="p-4 bg-slate-800/50 rounded-lg">
                            <h4 class="font-medium text-cyan-400 mb-2">Breakout Cable Details</h4>
                            <div class="text-sm space-y-2 text-gray-400">
                                <div><span class="text-gray-300">Spine Port:</span> QDD-400G-SR4.2-BD (400G QSFP-DD)</div>
                                <div><span class="text-gray-300">Breakout:</span> 4x QSFP-100G-SR1.2 (100G each)</div>
                                <div><span class="text-gray-300">ToR Side:</span> QSFP-100G-SR1.2 ($518.29 each)</div>
                                <div class="pt-2 border-t border-slate-600 mt-2">
                                    <span class="text-gray-300">Per Connection Cost:</span>
                                    <div class="text-xs mt-1" id="breakoutCostSummary">
                                        Breakout: $1,558.76 ÷ 4 = $389.69/port + ToR optic $518.29 = <span class="text-green-400">$907.98/link</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Saved Configurations -->
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="save" class="w-5 h-5 text-cyan-400"></i>Saved Configurations
                    </h2>
                    <div class="flex gap-2 mb-4">
                        <input type="text" id="configName" placeholder="Configuration name" class="input-field flex-1 px-3 py-2 rounded-lg text-white text-sm">
                        <button onclick="saveConfiguration(document.getElementById('configName').value)" class="px-4 py-2 bg-cyan-600 hover:bg-cyan-700 rounded-lg text-sm">Save</button>
                    </div>
                    <div id="savedConfigsList" class="space-y-2 max-h-48 overflow-y-auto"></div>
                    <div class="mt-4 pt-4 border-t border-slate-600">
                        <button onclick="shareConfiguration()" class="w-full px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg text-sm flex items-center justify-center gap-2">
                            <i data-lucide="share-2" class="w-4 h-4"></i>Share Configuration URL
                        </button>
                    </div>
                </div>

                <!-- Comparison Mode -->
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="git-compare" class="w-5 h-5 text-purple-400"></i>Workload Comparison
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Compare with:</label>
                            <select id="comparisonWorkloadSelect" class="input-field w-full px-3 py-2 rounded-lg text-white" onchange="setComparisonWorkload(this.value); enableComparisonMode()">
                                <option value="">-- Select workload to compare --</option>
                                <option value="high_compute">High Compute</option>
                                <option value="hadoop_data_node">Hadoop Data Node</option>
                                <option value="datawarehouse_amd">DataWarehouse - AMD</option>
                                <option value="datawarehouse_intel">DataWarehouse - Intel</option>
                                <option value="gp_local_intel">General Purpose Local Intel</option>
                                <option value="gp_san_intel">General Purpose SAN Intel</option>
                                <option value="db_local_intel">Database Local Intel</option>
                                <option value="db_san_intel">Database SAN Intel</option>
                                <option value="gp_local_amd">General Purpose Local AMD</option>
                                <option value="gp_san_amd">General Purpose SAN AMD</option>
                                <option value="db_local_amd">Database Local AMD</option>
                                <option value="db_san_amd">Database SAN AMD</option>
                                <option value="hypervisor">Hypervisor</option>
                                <option value="container_worker">Container Worker</option>
                                <option value="oracle_db_intel">Oracle DB Intel</option>
                                <option value="logging">Logging</option>
                                <option value="data_storage">Data Storage</option>
                            </select>
                        </div>
                        <div id="comparisonResults"></div>
                    </div>
                </div>

                <!-- Multi-Site Planning -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="globe" class="w-5 h-5 text-green-400"></i>Multi-Site Planning
                    </h2>
                    <div id="sitesContainer" class="space-y-2 mb-4"></div>
                    <button onclick="addSite()" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-sm flex items-center gap-2">
                        <i data-lucide="plus" class="w-4 h-4"></i>Add Site
                    </button>
                    <div id="multiSiteResults" class="mt-4"></div>
                </div>

                <!-- Custom Workload Builder -->
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="wrench" class="w-5 h-5 text-yellow-400"></i>Custom Workload Builder
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Workload Name *</label>
                            <input type="text" id="customWorkloadName" placeholder="My Custom Workload" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Server Power (W)</label>
                            <input type="number" id="customServerPower" value="500" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Server Cost ($)</label>
                            <input type="number" id="customServerCost" value="10000" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Server Height (U)</label>
                            <input type="number" id="customServerHeight" value="1" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Storage per Server (TB)</label>
                            <input type="number" id="customStoragePerServer" value="10" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">NIC Ports</label>
                            <input type="number" id="customNicPorts" value="2" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">Chassis</label>
                            <input type="text" id="customChassis" placeholder="e.g., Dell R750" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">CPU</label>
                            <input type="text" id="customCpu" placeholder="e.g., 2x Intel Xeon" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div>
                            <label class="block text-sm text-gray-400 mb-1">RAM</label>
                            <input type="text" id="customRam" placeholder="e.g., 512GB DDR5" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                        <div class="md:col-span-3">
                            <label class="block text-sm text-gray-400 mb-1">Description</label>
                            <input type="text" id="customDescription" placeholder="Brief description of workload" class="input-field w-full px-3 py-2 rounded-lg text-white">
                        </div>
                    </div>
                    <button onclick="saveCustomWorkload()" class="mt-4 px-6 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg font-medium flex items-center gap-2">
                        <i data-lucide="plus-circle" class="w-4 h-4"></i>Save Custom Workload
                    </button>
                </div>
            </div>
        </section>

        <!-- Summary Tab -->
        <section id="section-summary" class="tab-section hidden animate-fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="clipboard-list" class="w-5 h-5 text-cyan-400"></i>Executive Summary
                    </h2>
                    <div id="executiveSummary" class="prose prose-invert max-w-none"></div>
                </div>
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="lightbulb" class="w-5 h-5 text-yellow-400"></i>Recommendation
                    </h2>
                    <div id="recommendation" class="space-y-4"></div>
                </div>
                <div class="card rounded-xl p-6 lg:col-span-2">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="users" class="w-5 h-5 text-green-400"></i>Resource Requirements
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="resourceRequirements"></div>
                </div>
                <div class="card rounded-xl p-6">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="alert-triangle" class="w-5 h-5 text-red-400"></i>Risk Assessment
                    </h2>
                    <div id="riskAssessment" class="space-y-3"></div>
                </div>
                <div class="card rounded-xl p-6 lg:col-span-3">
                    <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                        <i data-lucide="download" class="w-5 h-5 text-purple-400"></i>Export & Share
                    </h2>
                    <div class="flex flex-wrap gap-3">
                        <button onclick="exportToJSON()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm">
                            <i data-lucide="file-json" class="w-4 h-4"></i>Export JSON
                        </button>
                        <button onclick="exportToCSV()" class="px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm">
                            <i data-lucide="file-spreadsheet" class="w-4 h-4"></i>Export CSV
                        </button>
                        <button onclick="exportBOM()" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm">
                            <i data-lucide="list" class="w-4 h-4"></i>Export Full BOM
                        </button>
                        <button onclick="exportExecutiveSummaryPDF()" class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm">
                            <i data-lucide="file-text" class="w-4 h-4"></i>Executive Summary PDF
                        </button>
                        <button onclick="printSummary()" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg font-medium transition-colors flex items-center gap-2 text-sm">
                            <i data-lucide="printer" class="w-4 h-4"></i>Print Summary
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-8 text-center text-gray-500 text-sm">
            <p>Prepared by Dan Stacks | <a href="/" class="text-cyan-400 hover:text-cyan-300">BaseConfig</a></p>
        </footer>
    </div>
    <script src="app.js"></script>
</body>
</html>
